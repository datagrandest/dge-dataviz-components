<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width,initial-scale=1'>
    <title>DataGrandEst dataviz components - Test</title>
    <link rel='icon' type='image/png' href='favicon.png'>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">

    <script src="dge-components/jquery/jquery-3.6.0.slim.min.js"></script>
    <script src="dge-components/popper/popper.min.js"></script>
    <script src="dge-components/bootstrap/js/bootstrap.min.js"></script>

    <!-- <script defer src='dge-components/index.js'></script> -->
    <script defer src='dge-components/dge-figure.js'></script>
    <script defer src='dge-components/dge-chart.js'></script>
</head>

<body>

    <div class="container-fluid my-3">

        <!-- <dge-chart id="dge-chart-1" api="csv" url="./data/test.csv" sql="SELECT commande AS x, quantite AS y1, quantite*prix AS y2 FROM ?" x="x" y="y1|y2" series="Y1|Y2" chart="bar|line" title="Quantité pour chaque ligne de commande du fichier data/test.csv" /> -->

        <!-- <div>
            <button id="changeSizeBtn" class="btn btn-primary" onclick="change()">Action</button>
        </div> -->

        <div class="row">
            <div class="col-2">

                <div class="h5 my-3">Territoire</div>
                <div class="btn-group-toggle btn-group-vertical w-100" data-toggle="buttons">
                    <label class="btn btn-outline-primary active">
                        <input type="radio" name="areaButton" id="grand-est" value="Grand Est" checked> Grand Est
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-67" value="67"> Bas-Rhin
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-68" value="68"> Haut-Rhin
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-08" value="8"> Ardennes
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-10" value="10"> Aube
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-51" value="51"> Marne
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-52" value="52"> Haute-Marne
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-54" value="54"> Meurthe
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-55" value="55"> Meurthe-et-Moselle
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-57" value="57"> Moselle
                    </label>
                    <label class="btn btn-outline-primary">
                        <input type="radio" name="areaButton" id="dept-88" value="88"> Vosges
                    </label>
                </div>

                <div class="h5 my-3">Date</div>
                <div class="">
                    <input for="dateLabel" list="dates" class="form-control" type="text" id="dateSelect" placeholder="Saissez une date" value="1996-01-01">
                    <datalist id="dates">
                        <option value="1996-01-01">1996-01-01</option>
                        <option value="1996-02-01">1996-02-01</option>
                        <option value="1996-03-01">1996-03-01</option>
                        <option value="1996-04-01">1996-04-01</option>
                        <option value="1996-05-01">1996-05-01</option>
                        <option value="1996-06-01">1996-06-01</option>
                        <option value="1996-07-01">1996-07-01</option>
                        <option value="1996-08-01">1996-08-01</option>
                        <option value="1996-09-01">1996-09-01</option>
                        <option value="1996-10-01">1996-10-01</option>
                        <option value="1996-11-01">1996-11-01</option>
                        <option value="1996-12-01">1996-12-01</option>
                        <option value="1997-01-01">1997-01-01</option>
                        <option value="1997-02-01">1997-02-01</option>
                        <option value="1997-03-01">1997-03-01</option>
                        <option value="1997-04-01">1997-04-01</option>
                        <option value="1997-05-01">1997-05-01</option>
                        <option value="1997-06-01">1997-06-01</option>
                        <option value="1997-07-01">1997-07-01</option>
                        <option value="1997-08-01">1997-08-01</option>
                        <option value="1997-09-01">1997-09-01</option>
                        <option value="1997-10-01">1997-10-01</option>
                        <option value="1997-11-01">1997-11-01</option>
                        <option value="1997-12-01">1997-12-01</option>
                        <option value="1998-01-01">1998-01-01</option>
                        <option value="1998-02-01">1998-02-01</option>
                        <option value="1998-03-01">1998-03-01</option>
                        <option value="1998-04-01">1998-04-01</option>
                        <option value="1998-05-01">1998-05-01</option>
                        <option value="1998-06-01">1998-06-01</option>
                        <option value="1998-07-01">1998-07-01</option>
                        <option value="1998-08-01">1998-08-01</option>
                        <option value="1998-09-01">1998-09-01</option>
                        <option value="1998-10-01">1998-10-01</option>
                        <option value="1998-11-01">1998-11-01</option>
                        <option value="1998-12-01">1998-12-01</option>
                        <option value="1999-01-01">1999-01-01</option>
                        <option value="1999-02-01">1999-02-01</option>
                        <option value="1999-03-01">1999-03-01</option>
                        <option value="1999-04-01">1999-04-01</option>
                        <option value="1999-05-01">1999-05-01</option>
                        <option value="1999-06-01">1999-06-01</option>
                        <option value="1999-07-01">1999-07-01</option>
                        <option value="1999-08-01">1999-08-01</option>
                        <option value="1999-09-01">1999-09-01</option>
                        <option value="1999-10-01">1999-10-01</option>
                        <option value="1999-11-01">1999-11-01</option>
                        <option value="1999-12-01">1999-12-01</option>
                        <option value="2000-01-01">2000-01-01</option>
                        <option value="2000-02-01">2000-02-01</option>
                        <option value="2000-03-01">2000-03-01</option>
                        <option value="2000-04-01">2000-04-01</option>
                        <option value="2000-05-01">2000-05-01</option>
                        <option value="2000-06-01">2000-06-01</option>
                        <option value="2000-07-01">2000-07-01</option>
                        <option value="2000-08-01">2000-08-01</option>
                        <option value="2000-09-01">2000-09-01</option>
                        <option value="2000-10-01">2000-10-01</option>
                        <option value="2000-11-01">2000-11-01</option>
                        <option value="2000-12-01">2000-12-01</option>
                        <option value="2001-01-01">2001-01-01</option>
                        <option value="2001-02-01">2001-02-01</option>
                        <option value="2001-03-01">2001-03-01</option>
                        <option value="2001-04-01">2001-04-01</option>
                        <option value="2001-05-01">2001-05-01</option>
                        <option value="2001-06-01">2001-06-01</option>
                        <option value="2001-07-01">2001-07-01</option>
                        <option value="2001-08-01">2001-08-01</option>
                        <option value="2001-09-01">2001-09-01</option>
                        <option value="2001-10-01">2001-10-01</option>
                        <option value="2001-11-01">2001-11-01</option>
                        <option value="2001-12-01">2001-12-01</option>
                        <option value="2002-01-01">2002-01-01</option>
                        <option value="2002-02-01">2002-02-01</option>
                        <option value="2002-03-01">2002-03-01</option>
                        <option value="2002-04-01">2002-04-01</option>
                        <option value="2002-05-01">2002-05-01</option>
                        <option value="2002-06-01">2002-06-01</option>
                        <option value="2002-07-01">2002-07-01</option>
                        <option value="2002-08-01">2002-08-01</option>
                        <option value="2002-09-01">2002-09-01</option>
                        <option value="2002-10-01">2002-10-01</option>
                        <option value="2002-11-01">2002-11-01</option>
                        <option value="2002-12-01">2002-12-01</option>
                        <option value="2003-01-01">2003-01-01</option>
                        <option value="2003-02-01">2003-02-01</option>
                        <option value="2003-03-01">2003-03-01</option>
                        <option value="2003-04-01">2003-04-01</option>
                        <option value="2003-05-01">2003-05-01</option>
                        <option value="2003-06-01">2003-06-01</option>
                        <option value="2003-07-01">2003-07-01</option>
                        <option value="2003-08-01">2003-08-01</option>
                        <option value="2003-09-01">2003-09-01</option>
                        <option value="2003-10-01">2003-10-01</option>
                        <option value="2003-11-01">2003-11-01</option>
                        <option value="2003-12-01">2003-12-01</option>
                        <option value="2004-01-01">2004-01-01</option>
                        <option value="2004-02-01">2004-02-01</option>
                        <option value="2004-03-01">2004-03-01</option>
                        <option value="2004-04-01">2004-04-01</option>
                        <option value="2004-05-01">2004-05-01</option>
                        <option value="2004-06-01">2004-06-01</option>
                        <option value="2004-07-01">2004-07-01</option>
                        <option value="2004-08-01">2004-08-01</option>
                        <option value="2004-09-01">2004-09-01</option>
                        <option value="2004-10-01">2004-10-01</option>
                        <option value="2004-11-01">2004-11-01</option>
                        <option value="2004-12-01">2004-12-01</option>
                        <option value="2005-01-01">2005-01-01</option>
                        <option value="2005-02-01">2005-02-01</option>
                        <option value="2005-03-01">2005-03-01</option>
                        <option value="2005-04-01">2005-04-01</option>
                        <option value="2005-05-01">2005-05-01</option>
                        <option value="2005-06-01">2005-06-01</option>
                        <option value="2005-07-01">2005-07-01</option>
                        <option value="2005-08-01">2005-08-01</option>
                        <option value="2005-09-01">2005-09-01</option>
                        <option value="2005-10-01">2005-10-01</option>
                        <option value="2005-11-01">2005-11-01</option>
                        <option value="2005-12-01">2005-12-01</option>
                        <option value="2006-01-01">2006-01-01</option>
                        <option value="2006-02-01">2006-02-01</option>
                        <option value="2006-03-01">2006-03-01</option>
                        <option value="2006-04-01">2006-04-01</option>
                        <option value="2006-05-01">2006-05-01</option>
                        <option value="2006-06-01">2006-06-01</option>
                        <option value="2006-07-01">2006-07-01</option>
                        <option value="2006-08-01">2006-08-01</option>
                        <option value="2006-09-01">2006-09-01</option>
                        <option value="2006-10-01">2006-10-01</option>
                        <option value="2006-11-01">2006-11-01</option>
                        <option value="2006-12-01">2006-12-01</option>
                        <option value="2007-01-01">2007-01-01</option>
                        <option value="2007-02-01">2007-02-01</option>
                        <option value="2007-03-01">2007-03-01</option>
                        <option value="2007-04-01">2007-04-01</option>
                        <option value="2007-05-01">2007-05-01</option>
                        <option value="2007-06-01">2007-06-01</option>
                        <option value="2007-07-01">2007-07-01</option>
                        <option value="2007-08-01">2007-08-01</option>
                        <option value="2007-09-01">2007-09-01</option>
                        <option value="2007-10-01">2007-10-01</option>
                        <option value="2007-11-01">2007-11-01</option>
                        <option value="2007-12-01">2007-12-01</option>
                        <option value="2008-01-01">2008-01-01</option>
                        <option value="2008-02-01">2008-02-01</option>
                        <option value="2008-03-01">2008-03-01</option>
                        <option value="2008-04-01">2008-04-01</option>
                        <option value="2008-05-01">2008-05-01</option>
                        <option value="2008-06-01">2008-06-01</option>
                        <option value="2008-07-01">2008-07-01</option>
                        <option value="2008-08-01">2008-08-01</option>
                        <option value="2008-09-01">2008-09-01</option>
                        <option value="2008-10-01">2008-10-01</option>
                        <option value="2008-11-01">2008-11-01</option>
                        <option value="2008-12-01">2008-12-01</option>
                        <option value="2009-01-01">2009-01-01</option>
                        <option value="2009-02-01">2009-02-01</option>
                        <option value="2009-03-01">2009-03-01</option>
                        <option value="2009-04-01">2009-04-01</option>
                        <option value="2009-05-01">2009-05-01</option>
                        <option value="2009-06-01">2009-06-01</option>
                        <option value="2009-07-01">2009-07-01</option>
                        <option value="2009-08-01">2009-08-01</option>
                        <option value="2009-09-01">2009-09-01</option>
                        <option value="2009-10-01">2009-10-01</option>
                        <option value="2009-11-01">2009-11-01</option>
                        <option value="2009-12-01">2009-12-01</option>
                        <option value="2010-01-01">2010-01-01</option>
                        <option value="2010-02-01">2010-02-01</option>
                        <option value="2010-03-01">2010-03-01</option>
                        <option value="2010-04-01">2010-04-01</option>
                        <option value="2010-05-01">2010-05-01</option>
                        <option value="2010-06-01">2010-06-01</option>
                        <option value="2010-07-01">2010-07-01</option>
                        <option value="2010-08-01">2010-08-01</option>
                        <option value="2010-09-01">2010-09-01</option>
                        <option value="2010-10-01">2010-10-01</option>
                        <option value="2010-11-01">2010-11-01</option>
                        <option value="2010-12-01">2010-12-01</option>
                        <option value="2011-01-01">2011-01-01</option>
                        <option value="2011-02-01">2011-02-01</option>
                        <option value="2011-03-01">2011-03-01</option>
                        <option value="2011-04-01">2011-04-01</option>
                        <option value="2011-05-01">2011-05-01</option>
                        <option value="2011-06-01">2011-06-01</option>
                        <option value="2011-07-01">2011-07-01</option>
                        <option value="2011-08-01">2011-08-01</option>
                        <option value="2011-09-01">2011-09-01</option>
                        <option value="2011-10-01">2011-10-01</option>
                        <option value="2011-11-01">2011-11-01</option>
                        <option value="2011-12-01">2011-12-01</option>
                        <option value="2012-01-01">2012-01-01</option>
                        <option value="2012-02-01">2012-02-01</option>
                        <option value="2012-03-01">2012-03-01</option>
                        <option value="2012-04-01">2012-04-01</option>
                        <option value="2012-05-01">2012-05-01</option>
                        <option value="2012-06-01">2012-06-01</option>
                        <option value="2012-07-01">2012-07-01</option>
                        <option value="2012-08-01">2012-08-01</option>
                        <option value="2012-09-01">2012-09-01</option>
                        <option value="2012-10-01">2012-10-01</option>
                        <option value="2012-11-01">2012-11-01</option>
                        <option value="2012-12-01">2012-12-01</option>
                        <option value="2013-01-01">2013-01-01</option>
                        <option value="2013-02-01">2013-02-01</option>
                        <option value="2013-03-01">2013-03-01</option>
                        <option value="2013-04-01">2013-04-01</option>
                        <option value="2013-05-01">2013-05-01</option>
                        <option value="2013-06-01">2013-06-01</option>
                        <option value="2013-07-01">2013-07-01</option>
                        <option value="2013-08-01">2013-08-01</option>
                        <option value="2013-09-01">2013-09-01</option>
                        <option value="2013-10-01">2013-10-01</option>
                        <option value="2013-11-01">2013-11-01</option>
                        <option value="2013-12-01">2013-12-01</option>
                        <option value="2014-01-01">2014-01-01</option>
                        <option value="2014-02-01">2014-02-01</option>
                        <option value="2014-03-01">2014-03-01</option>
                        <option value="2014-04-01">2014-04-01</option>
                        <option value="2014-05-01">2014-05-01</option>
                        <option value="2014-06-01">2014-06-01</option>
                        <option value="2014-07-01">2014-07-01</option>
                        <option value="2014-08-01">2014-08-01</option>
                        <option value="2014-09-01">2014-09-01</option>
                        <option value="2014-10-01">2014-10-01</option>
                        <option value="2014-11-01">2014-11-01</option>
                        <option value="2014-12-01">2014-12-01</option>
                        <option value="2015-01-01">2015-01-01</option>
                        <option value="2015-02-01">2015-02-01</option>
                        <option value="2015-03-01">2015-03-01</option>
                        <option value="2015-04-01">2015-04-01</option>
                        <option value="2015-05-01">2015-05-01</option>
                        <option value="2015-06-01">2015-06-01</option>
                        <option value="2015-07-01">2015-07-01</option>
                        <option value="2015-08-01">2015-08-01</option>
                        <option value="2015-09-01">2015-09-01</option>
                        <option value="2015-10-01">2015-10-01</option>
                        <option value="2015-11-01">2015-11-01</option>
                        <option value="2015-12-01">2015-12-01</option>
                        <option value="2016-01-01">2016-01-01</option>
                        <option value="2016-02-01">2016-02-01</option>
                        <option value="2016-03-01">2016-03-01</option>
                        <option value="2016-04-01">2016-04-01</option>
                        <option value="2016-05-01">2016-05-01</option>
                        <option value="2016-06-01">2016-06-01</option>
                        <option value="2016-07-01">2016-07-01</option>
                        <option value="2016-08-01">2016-08-01</option>
                        <option value="2016-09-01">2016-09-01</option>
                        <option value="2016-10-01">2016-10-01</option>
                        <option value="2016-11-01">2016-11-01</option>
                        <option value="2016-12-01">2016-12-01</option>
                        <option value="2017-01-01">2017-01-01</option>
                        <option value="2017-02-01">2017-02-01</option>
                        <option value="2017-03-01">2017-03-01</option>
                        <option value="2017-04-01">2017-04-01</option>
                        <option value="2017-05-01">2017-05-01</option>
                        <option value="2017-06-01">2017-06-01</option>
                        <option value="2017-07-01">2017-07-01</option>
                        <option value="2017-08-01">2017-08-01</option>
                        <option value="2017-09-01">2017-09-01</option>
                        <option value="2017-10-01">2017-10-01</option>
                        <option value="2017-11-01">2017-11-01</option>
                        <option value="2017-12-01">2017-12-01</option>
                        <option value="2018-01-01">2018-01-01</option>
                        <option value="2018-02-01">2018-02-01</option>
                        <option value="2018-03-01">2018-03-01</option>
                        <option value="2018-04-01">2018-04-01</option>
                        <option value="2018-05-01">2018-05-01</option>
                        <option value="2018-06-01">2018-06-01</option>
                        <option value="2018-07-01">2018-07-01</option>
                        <option value="2018-08-01">2018-08-01</option>
                        <option value="2018-09-01">2018-09-01</option>
                        <option value="2018-10-01">2018-10-01</option>
                        <option value="2018-11-01">2018-11-01</option>
                        <option value="2018-12-01">2018-12-01</option>
                        <option value="2019-01-01">2019-01-01</option>
                        <option value="2019-02-01">2019-02-01</option>
                        <option value="2019-03-01">2019-03-01</option>
                        <option value="2019-04-01">2019-04-01</option>
                        <option value="2019-05-01">2019-05-01</option>
                        <option value="2019-06-01">2019-06-01</option>
                        <option value="2019-07-01">2019-07-01</option>
                        <option value="2019-08-01">2019-08-01</option>
                        <option value="2019-09-01">2019-09-01</option>
                        <option value="2019-10-01">2019-10-01</option>
                        <option value="2019-11-01">2019-11-01</option>
                        <option value="2019-12-01">2019-12-01</option>
                        <option value="2020-01-01">2020-01-01</option>
                        <option value="2020-02-01">2020-02-01</option>
                        <option value="2020-03-01">2020-03-01</option>
                        <option value="2020-04-01">2020-04-01</option>
                        <option value="2020-05-01">2020-05-01</option>
                        <option value="2020-06-01">2020-06-01</option>
                        <option value="2020-07-01">2020-07-01</option>
                        <option value="2020-08-01">2020-08-01</option>
                        <option value="2020-09-01">2020-09-01</option>
                        <option value="2020-10-01">2020-10-01</option>
                        <option value="2020-11-01">2020-11-01</option>
                        <option value="2020-12-01">2020-12-01</option>
                        <option value="2021-01-01">2021-01-01</option>
                        <option value="2021-02-01">2021-02-01</option>
                        <option value="2021-03-01">2021-03-01</option>
                        <option value=""></option>
                    </datalist>
                </div>

            </div>
            <div class="col">
                <div class="row">
                    <div class="col-12">
                        <dge-figure id="dge-figure-1" attribution="DARES|https://dares.travail-emploi.gouv.fr/donnees/les-demandeurs-demploi-inscrits-pole-emploi" api="d4c"
                            url="https://dev.geograndest.fr/data4citizen/d4c/api/records/1.0/search/" datasets="test___donnees_dares_grand_est" max="10000" icon="people-fill" operation="sql|SUM(f0)" unit="personnes" filter=""
                            localcss="1" text="Somme des catégories A, B, C, D, E" decimal="0" sql="SELECT CONVERT(INT, cat_abcde) AS f0 FROM ? WHERE reg_new='Grand Est' AND date='1996-01-01'"></dge-figure>
                    </div>
                    <div class="col-6">
                        <div class="row">
                            <div class="col-12">
                                <dge-chart id="dge-chart-1" attribution="DARES|https://dares.travail-emploi.gouv.fr/donnees/les-demandeurs-demploi-inscrits-pole-emploi" api="d4c"
                                    url="https://dev.geograndest.fr/data4citizen/d4c/api/records/1.0/search/" datasets="test___donnees_dares_grand_est" max="10000"
                                    sql="SELECT dept AS x, cat_abcde AS y FROM ? WHERE reg_new='Grand Est' AND date='1996-01-01'" x="x" y="y" series="Toutes catégories" chart="bar" title="Répartition par département" />
                            </div>
                            <div id="graph-views" class="col-12 text-center mt-2">
                                <div class="btn-group-toggle btn-group w-50 mx-auto" data-toggle="buttons">
                                    <label class="btn btn-outline-success btn-sm active" name="chartLabel" id="label-bar">
                                        <input type="radio" name="chartButton" id="chart-bar" value="bar" checked><small>Bâtons</small>
                                    </label>
                                    <label class="btn btn-outline-success  btn-sm" name="chartLabel" id="label-pie">
                                        <input type="radio" name="chartButton" id="chart-pie" value="pie"><small>Camenbert</small>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <dge-chart id="dge-chart-evol" attribution="DARES|https://dares.travail-emploi.gouv.fr/donnees/les-demandeurs-demploi-inscrits-pole-emploi" api="d4c"
                            url="https://dev.geograndest.fr/data4citizen/d4c/api/records/1.0/search/" datasets="test___donnees_dares_grand_est" max="10000"
                            sql="SELECT date AS x, SUM(CONVERT(INT, cat_abcde)) AS y FROM ? WHERE reg_new='Grand Est' AND date LIKE '%-01-01' GROUP BY date ORDER BY date ASC" x="x" y="y" series="Toutes catégories"
                            chart="line" title="Evolution de 1996 à 2021" />
                    </div>
                </div>
            </div>

        </div>
    </div>

</body>

<script>
    var dateValue = "1996-01-01";
    var areaName = "Grand Est";
    var areaField = "reg_new";

    var dateSelect = document.getElementById("dateSelect");
    dateSelect.onchange = function () {
        if (this.value) {
            dateValue = this.value;
            const sql_figure = "SELECT CONVERT(INT, cat_abcde) AS f0 FROM ? WHERE " + areaField + "='" + areaName + "' AND date='" + dateValue + "'";
            const wc_figure = document.getElementById('dge-figure-1');
            wc_figure.sql = sql_figure;

            let chart_sql = "SELECT dept AS x, cat_a AS y1, cat_b AS y2, cat_c AS y3, cat_d AS y4, cat_e AS y5 FROM ? WHERE " + areaField + "='" + areaName + "' AND date='" + dateValue + "'";
            let chart_y = "y1|y2|y3|y4|y5";
            let chart_series = "Catégorie A|Catégorie B|Catégorie C|Catégorie D|Catégorie E";
            let chart_title = "Répartition par catégorie"
            if (areaField == "reg_new") {
                chart_sql = "SELECT dept AS x, cat_abcde AS y FROM ? WHERE " + areaField + "='" + areaName + "' AND date='" + dateValue + "'";
                chart_y = "y";
                chart_series = "Toutes catégories (A, B, C, D E)";
                chart_title = "Répartition par département"
            }

            const wc_chart = document.getElementById('dge-chart-1');
            wc_chart.sql = chart_sql;
            wc_chart.y = chart_y;
            wc_chart.series = chart_series;
            wc_chart.title = chart_title;

            console.log("change:", dateValue, areaField, areaName, sql_figure, chart_sql);
        }
    };

    var areaButtons = document.getElementsByName("areaButton");
    var prevArea = null;
    for (var i = 0, n = areaButtons.length; i < n; i++) {
        areaButtons[i].onclick = function () {
            if (this !== prevArea) {
                prevArea = this;
                areaField = this.value == "Grand Est" ? "reg_new" : "dept";
                areaName = this.value;

                const sql_figure = "SELECT CONVERT(INT, cat_abcde) AS f0 FROM ? WHERE " + areaField + "='" + areaName + "' AND date='" + dateValue + "'";
                const wc_figure = document.getElementById('dge-figure-1');
                wc_figure.sql = sql_figure;

                const chart_evol_sql = "SELECT date AS x, SUM(CONVERT(INT, cat_abcde)) AS y FROM ? WHERE " + areaField + "='" + areaName + "' AND date LIKE '%-01-01' GROUP BY date ORDER BY date ASC";
                const wc_chart_evol = document.getElementById('dge-chart-evol');
                wc_chart_evol.sql = chart_evol_sql;

                document.getElementById('graph-views').style.display = 'block'
                let chart_sql = "SELECT dept AS x, cat_abcde AS y FROM ? WHERE " + areaField + "='" + areaName + "' AND date='" + dateValue + "'";
                let chart_y = "y";
                let chart_series = "Toutes catégories (A, B, C, D E)";
                let chart_title = "Répartition par département"
                if (areaField == "dept") {
                    chart_sql = "SELECT dept AS x, cat_a AS y1, cat_b AS y2, cat_c AS y3, cat_d AS y4, cat_e AS y5 FROM ? WHERE " + areaField + "='" + areaName + "' AND date='" + dateValue + "'";
                    chart_y = "y1|y2|y3|y4|y5";
                    chart_series = "Catégorie A|Catégorie B|Catégorie C|Catégorie D|Catégorie E";
                    chart_title = "Répartition par catégorie"
                    var chartLabels = document.getElementsByName("chartLabel");
                    for (var i = 0, n = chartLabels.length; i < n; i++) {
                        chartLabels[i].classList.remove("active");
                    }
                    document.getElementById('label-bar').classList.add('active');
                    document.getElementById('graph-views').style.display = 'none'
                }

                const wc_chart = document.getElementById('dge-chart-1');
                wc_chart.chart = 'bar';
                wc_chart.sql = chart_sql;
                wc_chart.y = chart_y;
                wc_chart.series = chart_series;
                wc_chart.title = chart_title;
            }
        };
    }

    var chartButtons = document.getElementsByName("chartButton");
    var prevChart = null;

    for (var i = 0, n = chartButtons.length; i < n; i++) {
        chartButtons[i].onclick = function () {
            if (this !== prevChart) {
                if (this.value == 'pie') {
                    $("#grand-est[value='Grand Est']").attr("checked", true).trigger("change");
                    document.getElementById('grand-est').checked = true;
                    $('#grand-est').prop('checked', true);
                    areaField = "reg_new";
                    areaName = "Grand Est";
                    const wc_chart = document.getElementById('dge-chart-1');
                    wc_chart.sql = "SELECT dept AS x, cat_abcde AS y FROM ? WHERE " + areaField + "='" + areaName + "' AND date='" + dateValue + "'";
                    wc_chart.y = "y";
                    wc_chart.series = "Toutes catégories (A, B, C, D E)";
                    wc_chart.title = "Répartition par département"
                }
                const wc_chart = document.getElementById('dge-chart-1');
                wc_chart.chart = this.value;
                console.log("change:", this.value);
            }
        };
    }
</script>

</html>